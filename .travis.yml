cache: pip

sudo: required
jobs:
  include:
    - stage:
      language: python
      python: 2.7.12
      addons:
        firefox: latest-nightly
      env:
        - TOXENV=py27
        - MOZ_HEADLESS=1
      before_install:
        - wget -O /tmp/geckodriver.tar.gz https://github.com/mozilla/geckodriver/releases/download/v0.20.0/geckodriver-v0.20.0-linux64.tar.gz
        - mkdir $HOME/geckodriver && tar xvf /tmp/geckodriver.tar.gz -C $HOME/geckodriver
        - export PATH=$HOME/geckodriver:$PATH
        - firefox --version
        - geckodriver --version
      install:
        - pip install tox
      script: tox
      notifications:
        email: ksereduck@mozilla.com
    - stage:
      language: python
      python: 3.6
      addons:
        firefox: latest-nightly
      env:
        - TOXENV=py3
        - MOZ_HEADLESS=1
      before_install:
        - wget -O /tmp/geckodriver.tar.gz https://github.com/mozilla/geckodriver/releases/download/v0.20.0/geckodriver-v0.20.0-linux64.tar.gz
        - wget -O /tmp/geckodriver.tar.gz https://github.com/mozilla/geckodriver/releases/download/v0.20.0/geckodriver-v0.20.0-linux64.tar.gz
        - mkdir $HOME/geckodriver && tar xvf /tmp/geckodriver.tar.gz -C $HOME/geckodriver
        - export PATH=$HOME/geckodriver:$PATH
        - firefox --version
        - geckodriver --version
      install:
        - pip install tox
      script: tox
      notifications:
        email: ksereduck@mozilla.com
    - stage:
      language: python
      python: 3.6
      env: TOXENV=flake8
      install:
        - pip install tox
      script: tox
      notifications:
        email: ksereduck@mozilla.com
